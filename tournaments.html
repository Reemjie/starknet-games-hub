<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tournaments ‚Äî StarkGames Hub</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="shared.js"></script>
  <style>
    .page-wrap { max-width: 1280px; margin: 0 auto; padding: 40px 20px 80px; }
    /* STATUS PILLS */
    .s-live { display:inline-flex;align-items:center;gap:5px;padding:3px 10px;border-radius:999px;background:rgba(34,197,94,0.15);border:1px solid rgba(34,197,94,0.4);color:#22c55e;font-family:'Orbitron',sans-serif;font-size:9px;font-weight:700;letter-spacing:1px; }
    .s-soon { display:inline-flex;align-items:center;gap:5px;padding:3px 10px;border-radius:999px;background:rgba(244,197,66,0.15);border:1px solid rgba(244,197,66,0.4);color:#F4C542;font-family:'Orbitron',sans-serif;font-size:9px;font-weight:700;letter-spacing:1px; }
    .s-ended { display:inline-flex;align-items:center;gap:5px;padding:3px 10px;border-radius:999px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);color:rgba(255,255,255,0.3);font-family:'Orbitron',sans-serif;font-size:9px;font-weight:700;letter-spacing:1px; }
    .live-dot { width:5px;height:5px;border-radius:50%;background:#22c55e;animation:ld 1.5s infinite;flex-shrink:0; }
    @keyframes ld{0%,100%{opacity:1}50%{opacity:0.3}}
    /* FILTER BTNS */
    .ftab { padding:6px 16px;border-radius:8px;font-size:11px;font-weight:600;border:1px solid rgba(255,255,255,0.08);color:rgba(255,255,255,0.4);background:transparent;cursor:pointer;transition:all 0.2s;font-family:'Orbitron',sans-serif;letter-spacing:0.5px;white-space:nowrap; }
    .ftab:hover { border-color:rgba(255,255,255,0.2);color:rgba(255,255,255,0.7); }
    .ftab.active { border-color:#EC796B;color:white;background:rgba(236,121,107,0.15); }
    /* FEATURED CARD */
    #featuredCard { background:#13131A;border:1px solid #1F1F28;border-radius:18px;overflow:hidden;margin-bottom:20px;position:relative; }
    /* TOURNAMENT GRID */
    #tGrid { display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:14px; }
    .t-card { background:#13131A;border-radius:14px;border:1px solid #1F1F28;padding:18px;transition:all 0.3s;position:relative;overflow:hidden;cursor:pointer; }
    .t-card:hover { transform:translateY(-3px);border-color:var(--tc,rgba(236,121,107,0.5)); }
    /* PRIZE */
    .prize { display:inline-flex;align-items:center;gap:4px;padding:3px 10px;border-radius:7px;background:rgba(244,197,66,0.1);border:1px solid rgba(244,197,66,0.3);color:#F4C542;font-family:'Share Tech Mono',monospace;font-size:12px;font-weight:700; }
    /* FILL BAR */
    .fbar { height:4px;border-radius:2px;background:rgba(255,255,255,0.06);overflow:hidden;margin:8px 0; }
    .fbar-inner { height:4px;border-radius:2px;transition:width 1s ease; }
    /* COUNTDOWN */
    .cd-wrap { display:flex;gap:6px; }
    .cd-unit { display:flex;flex-direction:column;align-items:center;min-width:40px;padding:5px 7px;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.07);border-radius:7px; }
    .cd-n { font-family:'Share Tech Mono',monospace;font-size:16px;font-weight:700;color:white;line-height:1; }
    .cd-l { font-size:8px;color:rgba(255,255,255,0.3);letter-spacing:1px;text-transform:uppercase;margin-top:2px; }
    /* STATS */
    .stat-grid { display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:32px; }
    @media(max-width:640px){ .stat-grid { grid-template-columns:repeat(2,1fr); } }
    .stat-box { background:#13131A;border:1px solid #1F1F28;border-radius:12px;padding:14px;text-align:center; }
    .stat-n { font-family:'Orbitron',sans-serif;font-size:22px;font-weight:900;line-height:1; }
    .stat-l { font-family:'Orbitron',sans-serif;font-size:9px;color:rgba(255,255,255,0.28);letter-spacing:1.5px;text-transform:uppercase;margin-top:5px; }
    /* WINNERS */
    .winner-card { background:#13131A;border:1px solid #1F1F28;border-radius:12px;padding:13px 15px;display:flex;align-items:center;gap:12px; }
    @keyframes glo { 0%,100%{border-color:rgba(92,90,219,0.25);}50%{border-color:rgba(92,90,219,0.6);box-shadow:0 0 20px rgba(92,90,219,0.1);} }
    .glow-border { animation:glo 3s ease-in-out infinite; }
  </style>
</head>
<body>
<div class="page-wrap">

  <!-- HEADER -->
  <div style="text-align:center;margin-bottom:40px;">
    <div class="section-badge" style="margin-bottom:12px;display:inline-flex;"><span class="live-dot"></span>&nbsp;Tournaments</div>
    <h1 style="font-family:'Orbitron',sans-serif;font-size:clamp(26px,5vw,42px);font-weight:900;color:white;margin:0 0 8px;">Tournament <span class="gradient-text">Hub</span></h1>
    <p style="color:rgba(255,255,255,0.4);font-size:15px;margin:0 auto;max-width:460px;">Every Starknet competition in one place ‚Äî live countdowns, prize pools, instant access.</p>
  </div>

  <!-- STATS -->
  <div class="stat-grid">
    <div class="stat-box"><div class="stat-n" style="color:#22c55e;" id="cntLive">‚Äî</div><div class="stat-l">Live Now</div></div>
    <div class="stat-box"><div class="stat-n" style="color:#F4C542;" id="cntPrize">‚Äî</div><div class="stat-l">Total Prizes</div></div>
    <div class="stat-box"><div class="stat-n" style="color:#5C5ADB;" id="cntPlayers">‚Äî</div><div class="stat-l">Players Active</div></div>
    <div class="stat-box"><div class="stat-n" style="color:#EC796B;" id="cntSoon">‚Äî</div><div class="stat-l">Starting Soon</div></div>
  </div>

  <!-- FILTERS -->
  <div style="display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;gap:10px;margin-bottom:24px;">
    <div style="display:flex;gap:8px;flex-wrap:wrap;" id="statusFilters">
      <button class="ftab active" onclick="setFilter('all',this)">All</button>
      <button class="ftab" onclick="setFilter('live',this)">üî¥ Live</button>
      <button class="ftab" onclick="setFilter('upcoming',this)">‚è≥ Upcoming</button>
      <button class="ftab" onclick="setFilter('ended',this)">‚úì Ended</button>
    </div>
    <div style="display:flex;gap:8px;flex-wrap:wrap;" id="gameFilters">
      <button class="ftab active" onclick="setGameFilter('all',this)">All Games</button>
    </div>
  </div>

  <!-- FEATURED -->
  <div id="featuredWrap"></div>

  <!-- GRID -->
  <div id="tGrid"></div>

  <!-- SUBMIT CTA -->
  <div style="margin-top:36px;padding:22px 26px;border-radius:16px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:14px;" class="glow-border" style="border:1px dashed rgba(92,90,219,0.3);background:rgba(92,90,219,0.04);">
    <div>
      <h4 style="font-family:'Orbitron',sans-serif;font-size:14px;font-weight:700;color:white;margin:0 0 4px;">Organizing a tournament?</h4>
      <p style="color:rgba(255,255,255,0.35);font-size:13px;margin:0;">Submit it and reach the full Starknet gaming community.</p>
    </div>
    <a href="https://x.com/Reemjie_" target="_blank" class="btn-primary" style="background:rgba(92,90,219,0.15);border:1px solid rgba(92,90,219,0.4);box-shadow:none;">
      <svg width="13" height="13" fill="currentColor" viewBox="0 0 24 24"><path d="M18.9 2H22l-6.6 7.5L23 22h-6.7l-5.2-6.7L5 22H2l7.1-8.2L1 2h6.8l4.7 6.1L18.9 2z"/></svg>
      DM @Reemjie_
    </a>
  </div>

  <!-- RECENT WINNERS -->
  <div style="margin-top:56px;">
    <div style="display:flex;align-items:center;gap:16px;margin-bottom:20px;">
      <div style="flex:1;height:1px;background:rgba(255,255,255,0.05);"></div>
      <span style="font-family:'Orbitron',sans-serif;font-size:10px;color:rgba(255,255,255,0.2);letter-spacing:2px;white-space:nowrap;">RECENT WINNERS</span>
      <div style="flex:1;height:1px;background:rgba(255,255,255,0.05);"></div>
    </div>
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(230px,1fr));gap:10px;" id="winnersGrid"></div>
  </div>

</div>

<script>
var _statusFilter = 'all';
var _gameFilter   = 'all';
var _cdTimers = {};
var _allTourneys = [];

function setFilter(f, btn) {
  _statusFilter = f;
  document.querySelectorAll('#statusFilters .ftab').forEach(function(b){b.classList.remove('active');});
  btn.classList.add('active');
  render();
}
function setGameFilter(g, btn) {
  _gameFilter = g;
  document.querySelectorAll('#gameFilters .ftab').forEach(function(b){b.classList.remove('active');});
  btn.classList.add('active');
  render();
}

function cdStr(endTs) {
  var diff = Math.max(0, endTs - Date.now());
  var totalH = Math.floor(diff / 3600000);
  var d = Math.floor(totalH / 24), h = totalH % 24;
  var m = Math.floor((diff % 3600000) / 60000);
  var s = Math.floor((diff % 60000) / 1000);
  var parts = d > 0
    ? [{v:d,l:'days'},{v:h,l:'hrs'},{v:m,l:'min'}]
    : [{v:h,l:'hrs'},{v:m,l:'min'},{v:s,l:'sec'}];
  var h2 = '<div class="cd-wrap">';
  parts.forEach(function(p) {
    h2 += '<div class="cd-unit"><div class="cd-n">' + String(p.v).padStart(2,'0') + '</div><div class="cd-l">' + p.l + '</div></div>';
  });
  return h2 + '</div>';
}

function startCD(elId, endTs) {
  if (_cdTimers[elId]) clearInterval(_cdTimers[elId]);
  function tick() {
    var el = document.getElementById(elId);
    if (!el) { clearInterval(_cdTimers[elId]); return; }
    el.innerHTML = cdStr(endTs);
    if (endTs <= Date.now()) clearInterval(_cdTimers[elId]);
  }
  tick();
  _cdTimers[elId] = setInterval(tick, 1000);
}

function statusPill(s) {
  if (s === 'live')     return '<span class="s-live"><span class="live-dot"></span>LIVE</span>';
  if (s === 'upcoming') return '<span class="s-soon">‚è≥ SOON</span>';
  return '<span class="s-ended">‚úì ENDED</span>';
}

function renderFeatured(t) {
  if (!t) { document.getElementById('featuredWrap').innerHTML = ''; return; }
  var pct = t.maxPlayers > 0 ? Math.round(t.players / t.maxPlayers * 100) : 0;
  var h = '<div id="featuredCard">';
  h +=   '<div style="position:absolute;top:0;right:0;bottom:0;width:38%;overflow:hidden;border-radius:0 18px 18px 0;">';
  h +=     '<img src="' + t.gameImg + '" style="width:100%;height:100%;object-fit:cover;opacity:0.15;filter:saturate(0.3);">';
  h +=     '<div style="position:absolute;inset:0;background:linear-gradient(90deg,#13131A,transparent 60%);"></div>';
  h +=   '</div>';
  h +=   '<div style="padding:26px 30px;position:relative;z-index:2;">';
  h +=     '<div style="display:flex;align-items:center;gap:10px;margin-bottom:12px;">';
  h +=       '<span style="background:linear-gradient(135deg,' + t.color + ',#f97316);padding:2px 10px;border-radius:5px;font-family:Orbitron,sans-serif;font-size:9px;font-weight:700;color:#000;letter-spacing:1px;">‚ú¶ FEATURED</span>';
  h +=       statusPill(t.status);
  h +=     '</div>';
  h +=     '<h2 style="font-family:Orbitron,sans-serif;font-size:clamp(18px,3vw,28px);font-weight:900;color:white;margin:0 0 6px;max-width:58%;">' + t.name + '</h2>';
  h +=     '<p style="color:rgba(255,255,255,0.4);font-size:13px;max-width:50%;margin:0 0 18px;line-height:1.6;">' + (t.desc||'') + '</p>';
  h +=     '<div style="display:flex;flex-wrap:wrap;align-items:center;gap:20px;margin-bottom:20px;">';
  h +=       '<div><div style="font-size:9px;color:rgba(255,255,255,0.28);letter-spacing:1px;text-transform:uppercase;margin-bottom:4px;">Prize Pool</div><span class="prize">üèÜ ' + t.prize + '</span></div>';
  h +=       '<div><div style="font-size:9px;color:rgba(255,255,255,0.28);letter-spacing:1px;text-transform:uppercase;margin-bottom:4px;">Players</div><div style="font-family:Share Tech Mono,monospace;font-size:14px;color:white;">' + t.players + ' / ' + t.maxPlayers + '</div><div class="fbar" style="width:130px;margin-top:4px;"><div class="fbar-inner" style="width:' + pct + '%;background:' + t.color + ';"></div></div></div>';
  h +=       '<div><div style="font-size:9px;color:rgba(255,255,255,0.28);letter-spacing:1px;text-transform:uppercase;margin-bottom:4px;">Ends In</div><div id="cdFeatured"></div></div>';
  h +=     '</div>';
  h +=     '<div style="display:flex;gap:10px;flex-wrap:wrap;">';
  h +=       '<a href="' + t.url + '" target="_blank" class="btn-primary"><svg width="13" height="13" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/></svg> Join Tournament</a>';
  h +=     '</div>';
  h +=   '</div>';
  h += '</div>';
  document.getElementById('featuredWrap').innerHTML = h;
  if (t.endTimestamp) startCD('cdFeatured', t.endTimestamp);
}

function render() {
  var list = _allTourneys.filter(function(t) {
    if (!t.active) return false;
    if (t.featured) return false;
    if (_statusFilter !== 'all' && t.status !== _statusFilter) return false;
    if (_gameFilter   !== 'all' && t.game   !== _gameFilter)   return false;
    return true;
  });

  if (!list.length) {
    document.getElementById('tGrid').innerHTML = '<p style="color:rgba(255,255,255,0.2);font-family:Orbitron,sans-serif;font-size:11px;letter-spacing:2px;padding:40px 0;grid-column:1/-1;">NO TOURNAMENTS FOUND</p>';
    return;
  }

  var html = '';
  list.forEach(function(t) {
    var pct = t.maxPlayers > 0 ? Math.round(t.players / t.maxPlayers * 100) : 0;
    var tagsH = '';
    (t.tags||[]).forEach(function(tag) {
      tagsH += '<span style="padding:2px 7px;border-radius:4px;font-size:9px;background:rgba(255,255,255,0.05);color:rgba(255,255,255,0.3);font-weight:600;">' + tag + '</span>';
    });
    html += '<div class="t-card" style="--tc:' + (t.color||'#EC796B') + '50;" onclick="window.open(\'' + t.url + '\',\'_blank\')">';
    html +=   '<div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px;">';
    html +=     '<div style="display:flex;align-items:center;gap:10px;">';
    html +=       '<img src="' + t.gameImg + '" style="width:36px;height:36px;border-radius:8px;object-fit:cover;border:1px solid ' + (t.color||'#EC796B') + '40;flex-shrink:0;">';
    html +=       '<div><div style="font-size:10px;color:rgba(255,255,255,0.3);">' + t.game + '</div><div style="font-weight:700;font-size:14px;color:white;">' + t.name + '</div></div>';
    html +=     '</div>';
    html +=     statusPill(t.status);
    html +=   '</div>';
    html +=   '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">';
    html +=     '<span class="prize" style="font-size:11px;">' + t.prize + '</span>';
    html +=     '<span style="font-family:Share Tech Mono,monospace;font-size:11px;color:rgba(255,255,255,0.35);">' + t.players + '/' + t.maxPlayers + '</span>';
    html +=   '</div>';
    html +=   '<div class="fbar"><div class="fbar-inner" style="width:' + pct + '%;background:' + (t.color||'#EC796B') + ';opacity:0.7;"></div></div>';
    html +=   '<div style="display:flex;flex-wrap:wrap;gap:4px;margin-bottom:10px;">' + tagsH;
    if (t.host) html += '<span style="padding:2px 7px;border-radius:4px;font-size:9px;background:rgba(255,255,255,0.03);color:rgba(255,255,255,0.2);">' + t.host + '</span>';
    html +=   '</div>';
    if (t.status !== 'ended' && t.endTimestamp) {
      html += '<div id="cd_' + t.id + '" style="margin-top:6px;"></div>';
    }
    if (t.winner) {
      html += '<div style="margin-top:8px;font-size:11px;color:rgba(255,255,255,0.28);">üèÜ Winner: <span style="font-family:Share Tech Mono,monospace;color:#F4C542;">' + t.winner + '</span></div>';
    }
    if (t.status !== 'ended') {
      html += '<div style="margin-top:12px;padding-top:10px;border-top:1px solid rgba(255,255,255,0.05);text-align:right;"><span style="font-size:12px;font-weight:700;color:' + (t.color||'#EC796B') + ';">Enter ‚Üí</span></div>';
    }
    html += '</div>';
  });
  document.getElementById('tGrid').innerHTML = html;

  // Start countdowns after render
  list.forEach(function(t) {
    if (t.status !== 'ended' && t.endTimestamp && document.getElementById('cd_' + t.id)) {
      startCD('cd_' + t.id, t.endTimestamp);
    }
  });
}

function renderStats(tours) {
  var live    = tours.filter(function(t){return t.active && t.status==='live';});
  var upcoming= tours.filter(function(t){return t.active && t.status==='upcoming';});
  var players = live.reduce(function(s,t){return s+(t.players||0);},0);
  document.getElementById('cntLive').textContent    = live.length;
  document.getElementById('cntSoon').textContent    = upcoming.length;
  document.getElementById('cntPlayers').textContent = players > 0 ? players : '‚Äî';
  document.getElementById('cntPrize').textContent   = '$' + (12.4) + 'k';
}

function renderGameFilters(tours) {
  var games = {};
  tours.forEach(function(t){ if(t.game) games[t.game]=true; });
  var html = '<button class="ftab active" onclick="setGameFilter(\'all\',this)">All Games</button>';
  Object.keys(games).forEach(function(g) {
    html += '<button class="ftab" onclick="setGameFilter(\'' + g.replace(/'/g,"\\'") + '\',this)">' + g + '</button>';
  });
  document.getElementById('gameFilters').innerHTML = html;
}

function renderWinners(tours) {
  var ended = tours.filter(function(t){ return t.active && t.status === 'ended' && t.winner; });
  if (!ended.length) {
    document.getElementById('winnersGrid').innerHTML = '<p style="color:rgba(255,255,255,0.18);font-size:12px;font-family:Orbitron,sans-serif;letter-spacing:1px;">NO RECENT WINNERS YET</p>';
    return;
  }
  var html = '';
  ended.slice(0, 6).forEach(function(t) {
    html += '<div class="winner-card">';
    html +=   '<div style="width:36px;height:36px;border-radius:50%;background:' + (t.color||'#F4C542') + '18;border:1px solid ' + (t.color||'#F4C542') + '35;display:flex;align-items:center;justify-content:center;font-size:16px;flex-shrink:0;">üèÜ</div>';
    html +=   '<div style="min-width:0;flex:1;">';
    html +=     '<div style="font-weight:700;font-size:13px;color:white;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">' + t.name + '</div>';
    html +=     '<div style="font-family:Share Tech Mono,monospace;font-size:10px;color:' + (t.color||'#F4C542') + ';margin:2px 0;">' + (t.winnerPrize || t.prize) + '</div>';
    html +=     '<div style="font-size:10px;color:rgba(255,255,255,0.2);">' + t.winner + ' ¬∑ ' + (t.game||'') + '</div>';
    html +=   '</div>';
    html += '</div>';
  });
  document.getElementById('winnersGrid').innerHTML = html;
}

loadSiteData().then(function(D) {
  _allTourneys = (D.tournaments || []);
  var featured = _allTourneys.find(function(t){ return t.active && t.featured; });
  renderFeatured(featured || null);
  renderStats(_allTourneys);
  renderGameFilters(_allTourneys);
  renderWinners(_allTourneys);
  render();
});
</script>
</body>
</html>
